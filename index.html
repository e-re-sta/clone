<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OrangeWeb</title>
<style>
    body {
        background:#222;
        color:#fff;
        font-family:sans-serif;
        margin:0;
        text-align:center;
    }
    h1{
        margin:20px 0;
    }
    .gameButton{
        background:orange;
        color:black;
        padding:15px 25px;
        margin:10px;
        border:none;
        border-radius:6px;
        cursor:pointer;
        font-size:18px;
        font-weight:bold;
    }
    #agentBirdWrapper{
        display:none;
        position:relative;
        margin:auto;
        margin-top:20px;
        width:800px;
        height:500px;
        border:2px solid #444;
        border-radius:8px;
        overflow:hidden;
        background:black;
    }
    #agentBirdCanvas{
        width:100%;
        height:100%;
    }
    #scoreDisplay{
        position:absolute;
        top:10px;
        left:10px;
        color:white;
        font-size:22px;
        font-weight:bold;
    }
    #backBtn{
        position:absolute;
        top:10px;
        right:10px;
        padding:10px 20px;
        background:red;
        color:white;
        border:none;
        border-radius:6px;
        cursor:pointer;
        font-size:16px;
    }
</style>
</head>
<body>

<h1>OrangeWeb</h1>

<button class="gameButton" onclick="openAgentBird()">
    AgentBird â€“ Fly & Shoot Game
</button>

<!-- GAME WRAPPER -->
<div id="agentBirdWrapper">
    <canvas id="agentBirdCanvas" width="800" height="500"></canvas>
    <div id="scoreDisplay">Score: 0</div>
    <button id="backBtn" onclick="backToMain()">Back</button>
</div>

<script>
// === GLOBALS ===
const wrapper = document.getElementById("agentBirdWrapper");
const canvas = document.getElementById("agentBirdCanvas");
const ctx = canvas.getContext("2d");
const scoreDisplay = document.getElementById("scoreDisplay");
let player, bullets, enemies, score, shootCooldown, gameOn, loopId;

// === INPUT ===
canvas.addEventListener("mousemove", e => {
    if(!gameOn) return;
    const rect = canvas.getBoundingClientRect();
    player.y = e.clientY - rect.top - player.height/2;
});
canvas.addEventListener("touchmove", e => {
    if(!gameOn) return;
    const rect = canvas.getBoundingClientRect();
    player.y = e.touches[0].clientY - rect.top - player.height/2;
    e.preventDefault();
});
canvas.addEventListener("click", shoot);

function shoot(){
    if(!gameOn) return;
    if(shootCooldown <= 0){
        bullets.push({
            x: player.x + player.width,
            y: player.y + player.height/2 - 2,
            width: 12,
            height: 4,
            speed: 8
        });
        shootCooldown = 20;
    }
}

// === UI ===
function openAgentBird(){
    wrapper.style.display = "block";
    startGame();
}
function backToMain(){
    wrapper.style.display = "none";
    gameOn = false;
    cancelAnimationFrame(loopId);
}

// === GAME START ===
function startGame(){
    player = { x:100, y:250, width:40, height:30, color:'orange' };
    bullets = [];
    enemies = [];
    score = 0;
    shootCooldown = 0;
    gameOn = true;

    loop();
}

// === GAME LOOP ===
function loop(){
    update();
    draw();
    if(gameOn) loopId = requestAnimationFrame(loop);
}

// === UPDATE ===
function update(){
    // Keep player in bounds
    if(player.y < 0) player.y = 0;
    if(player.y + player.height > canvas.height - 50)
        player.y = canvas.height - 50 - player.height;

    // Spawn enemies
    if(Math.random() < 0.02){
        enemies.push({
            x: canvas.width,
            y: Math.random() * (canvas.height - 80),
            width: 50,
            height: 40,
            speed: 2 + Math.random() * 2
        });
    }

    // Update bullets
    bullets.forEach((b, i)=>{
        b.x += b.speed;
        if(b.x > canvas.width) bullets.splice(i,1);

        enemies.forEach((e, j)=>{
            if(b.x < e.x + e.width &&
               b.x + b.width > e.x &&
               b.y < e.y + e.height &&
               b.y + b.height > e.y){
                bullets.splice(i,1);
                enemies.splice(j,1);
            }
        });
    });

    // Update enemies
    enemies.forEach((e,i)=>{
        e.x -= e.speed;
        if(e.x + e.width < 0) enemies.splice(i,1);
    });

    if(shootCooldown > 0) shootCooldown--;

    score += 0.1;
    scoreDisplay.innerText = "Score: " + Math.floor(score);
}

// === DRAW ===
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Sky
    ctx.fillStyle = "#87CEEB";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // Ground
    ctx.fillStyle = "#2e8b57";
    ctx.fillRect(0, canvas.height - 50, canvas.width, 50);

    // Player
    ctx.fillStyle = player.color;
    ctx.fillRect(player.x, player.y, player.width, player.height);

    // Bullets
    ctx.fillStyle = "yellow";
    bullets.forEach(b=>{
        ctx.fillRect(b.x, b.y, b.width, b.height);
    });

    // Enemies
    ctx.fillStyle = "gray";
    enemies.forEach(e=>{
        ctx.fillRect(e.x, e.y, e.width, e.height);
    });
}

</script>
</body>
</html>
