<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clone Game Hub</title>
<style>
  :root {
    --bg-light: #f0f0f0;
    --bg-dark: #121212;
    --text-light: #000;
    --text-dark: #fff;
    --button-bg: #007bff;
    --button-hover: #0056b3;
  }
  body {
    margin:0;
    font-family: Arial, sans-serif;
    background-color: var(--bg-light);
    color: var(--text-light);
    transition: background-color 0.3s, color 0.3s;
  }
  body.dark {
    background-color: var(--bg-dark);
    color: var(--text-dark);
  }
  header { padding: 1rem; background-color: #333; color: #fff; text-align:center; cursor:pointer; }
  #main { padding: 1rem; }
  button { padding: 1rem; background-color: var(--button-bg); border:none; color:#fff; cursor:pointer; transition: background-color 0.2s; margin:0.2rem;}
  button:hover { background-color: var(--button-hover); }
  #dark-toggle { position:fixed; top:1rem; right:1rem; padding:0.5rem 1rem; cursor:pointer; background-color:#555; color:#fff; border:none; }
  #game-info { margin-bottom:1rem; }
</style>
</head>
<body>
<header id="reload-header">clone</header>
<button id="dark-toggle">Toggle Darkmode</button>
<div id="main"></div>

<!-- Wallet Libraries -->
<script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.7.8/dist/umd/index.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
<script src="https://unpkg.com/@solana/web3.js@1.74.0/lib/index.iife.js"></script>

<script>
  // Darkmode persist
  let dark = localStorage.getItem('dark') === 'true';
  if(dark) document.body.classList.add('dark');
  document.getElementById('dark-toggle').addEventListener('click', () => {
    document.body.classList.toggle('dark');
    dark = document.body.classList.contains('dark');
    localStorage.setItem('dark', dark);
  });

  // Reload header
  document.getElementById('reload-header').addEventListener('click', ()=> location.reload());

  // Wallet addresses (einmalig)
  const wallets = { eth:"ETH_ADDRESS_HERE", sol:"SOL_ADDRESS_HERE" };

  function renderMain() {
    const main = document.getElementById('main');
    main.innerHTML = '';
    const btn = document.createElement('button');
    btn.textContent = 'Game 1';
    btn.addEventListener('click', loadGame);
    main.appendChild(btn);
  }

  function loadGame() {
    const main = document.getElementById('main');
    main.innerHTML = '';
    
    // Game variables
    const canvasSize = 400;
    let x=50, y=50, size=30;
    let dx=0, dy=0;
    let level=1, points=0, lives=3;
    const obstacles = [];

    // Create canvas and info
    const gameDiv = document.createElement('div');
    gameDiv.innerHTML = `
      <div id="game-info">Level: ${level} | Points: ${points} | Lives: ${lives}</div>
      <canvas id="gameCanvas" width="${canvasSize}" height="${canvasSize}" style="border:1px solid #000;"></canvas>
      <div style="margin-top:1rem;">
        <button id="pay-eth">Pay 0.000001 ETH to continue</button>
        <button id="pay-sol">Pay 0.50 USD in SOL for 6 lives</button>
      </div>
      <button id="back-main" style="position:fixed; bottom:1rem; left:1rem;">â¬… Back</button>
    `;
    main.appendChild(gameDiv);

    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Back button
    document.getElementById('back-main').addEventListener('click', renderMain);

    // Payment placeholders
    document.getElementById('pay-eth').addEventListener('click', ()=>{
      alert(`ETH payment to ${wallets.eth} placeholder`);
      level++; updateInfo();
    });
    document.getElementById('pay-sol').addEventListener('click', ()=>{
      alert(`SOL payment to ${wallets.sol} placeholder`);
      lives+=6; updateInfo();
    });

    // Info update
    function updateInfo() {
      document.getElementById('game-info').textContent = `Level: ${level} | Points: ${points} | Lives: ${lives}`;
    }

    // Generate obstacles for each level
    function generateObstacles() {
      obstacles.length=0;
      for(let i=0;i<level+2;i++){
        obstacles.push({x:Math.random()*(canvasSize-20), y:Math.random()*(canvasSize-20), size:20});
      }
    }

    generateObstacles();

    // Keyboard controls
    const keys = {};
    document.addEventListener('keydown', (e)=>keys[e.key]=true);
    document.addEventListener('keyup', (e)=>keys[e.key]=false);

    function gameLoop(){
      ctx.clearRect(0,0,canvasSize,canvasSize);
      dx=0; dy=0;
      if(keys['ArrowUp']) dy=-2;
      if(keys['ArrowDown']) dy=2;
      if(keys['ArrowLeft']) dx=-2;
      if(keys['ArrowRight']) dx=2;

      x+=dx; y+=dy;
      // Boundaries
      if(x<0)x=0; if(y<0)y=0;
      if(x+size>canvasSize)x=canvasSize-size;
      if(y+size>canvasSize)y=canvasSize-size;

      // Draw player
      ctx.fillStyle='red';
      ctx.fillRect(x,y,size,size);

      // Draw obstacles
      ctx.fillStyle='black';
      obstacles.forEach(ob=>{
        ctx.fillRect(ob.x, ob.y, ob.size, ob.size);
        // Collision
        if(x<ob.x+ob.size && x+size>ob.x && y<ob.y+ob.size && y+size>ob.y){
          lives--;
          updateInfo();
          x=50; y=50; // reset position
          if(lives<=0){
            alert('Game Over');
            renderMain();
            return;
          }
        }
      });

      // Level up
      if(points >= level*5){
        level++;
        points=0;
        generateObstacles();
        updateInfo();
        if(level>=8){
          alert('Pay 0.000001 ETH to continue');
          // Require ETH payment
        }
      }

      points++;
      updateInfo();
      requestAnimationFrame(gameLoop);
    }
    gameLoop();
  }

  renderMain();
</script>
</body>
</html>
